$ ->
  window.minThoughtWallRefreshDelay = 1500
  window.maxThoughtLength = 65500
  
  window.thoughtWallTitleInput = $("#thought_wall_title")

  window.overlayDiv = $('#overlay')
  window.overlayContentDiv = $('#overlay-content')

  window.recentThoughtWallsLink = $('#recent-thought-walls-link')
  window.recentThoughtWallsDiv = $("#recent-thought-walls")
  
  window.thoughtHistoriesLinks = $(".thought-history-link")
  window.thoughtHistoryBoxes = $(".thought-histories-box")

  window.renderTimestampDiv = $('#render_timestamp')
  window.nextThoughtWallRefreshDiv = $('#next_refresh')

  window.newThoughtTextarea = $('#thought_text')
  window.newThoughtTextRemainingCountDiv = $('#thought-new-remaining-characters')

  window.thoughtListDiv = $("#thought-list")

  window.focusOnNewThoughtText = ->
    newThoughtTextarea.focus()

  window.getOverlayIsVisible = ->
    (overlayDiv.css('display') != 'none')
    
  window.getCurrThoughtWallRefreshDelay = ->
    delayFromDOM = parseInt(nextThoughtWallRefreshDiv.html())
    if (isNaN(delayFromDOM) || delayFromDOM < minThoughtWallRefreshDelay)
      minThoughtWallRefreshDelay
    else
      delayFromDOM

  window.getRenderTimestamp = ->
    renderTimestampDiv.html()

  window.setRenderTimestamp = (renderTimestamp) ->
    renderTimestampDiv.html(renderTimestamp)

  window.setNextThoughtWallRefreshDelay = (nextRefreshDelay) ->
    nextThoughtWallRefreshDiv.html(nextRefreshDelay)

  window.clearNewThoughtForm = ->
    newThoughtTextarea.val('')
    newThoughtTextRemainingCountDiv.html('remaining: ' + (maxThoughtLength - newThoughtTextarea.val().length))

  window.ajaxRefreshPage = ->
    $.get document.URL+".js?since="+getRenderTimestamp()+"&next_refresh="+getCurrThoughtWallRefreshDelay()

  window.numericalOrder = ->
    shiftThought($('#thought-box-229').index(), 0)
    shiftThought($('#thought-box-230').index(), 1)
    shiftThought($('#thought-box-231').index(), 2)
    shiftThought($('#thought-box-232').index(), 3)
    shiftThought($('#thought-box-233').index(), 4)
    shiftThought($('#thought-box-234').index(), 5)
    shiftThought($('#thought-box-235').index(), 6)
    shiftThought($('#thought-box-236').index(), 7)
    shiftThought($('#thought-box-237').index(), 8)
    shiftThought($('#thought-box-238').index(), 9)
    shiftThought($('#thought-box-239').index(), 10)
    shiftThought($('#thought-box-240').index(), 11)
    shiftThought($('#thought-box-241').index(), 12)
    shiftThought($('#thought-box-242').index(), 13)
    shiftThought($('#thought-box-243').index(), 14)
  
  window.reverseNumericalOrder = ->
    shiftThought($('#thought-box-243').index(), 0)
    shiftThought($('#thought-box-242').index(), 1)
    shiftThought($('#thought-box-241').index(), 2)
    shiftThought($('#thought-box-240').index(), 3)
    shiftThought($('#thought-box-239').index(), 4)
    shiftThought($('#thought-box-238').index(), 5)
    shiftThought($('#thought-box-237').index(), 6)
    shiftThought($('#thought-box-236').index(), 7)
    shiftThought($('#thought-box-235').index(), 8)
    shiftThought($('#thought-box-234').index(), 9)
    shiftThought($('#thought-box-233').index(), 10)
    shiftThought($('#thought-box-232').index(), 11)
    shiftThought($('#thought-box-231').index(), 12)
    shiftThought($('#thought-box-230').index(), 13)        
    shiftThought($('#thought-box-229').index(), 14)
    
    
    
    
    
    
    
    




    
    
    
    

  $(document).ready ->
    addThoughtWallCodeToRecentList($('#thought-wall-code').html(), $('title').html())
    delayAction(ajaxRefreshPage, minThoughtWallRefreshDelay)